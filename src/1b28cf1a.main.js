/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: mark@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: david@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

!function(){var t,e,i;!function(n){function s(t,e){return S.call(t,e)}function r(t,e){var i,n,s,r,o,a,h,u,c,l,p,f=e&&e.split("/"),d=v.map,y=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(f=f.slice(0,f.length-1),t=t.split("/"),o=t.length-1,v.nodeIdCompat&&x.test(t[o])&&(t[o]=t[o].replace(x,"")),t=f.concat(t),c=0;c<t.length;c+=1)if(p=t[c],"."===p)t.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||y)&&d){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),f)for(l=f.length;l>0;l-=1)if(s=d[f.slice(0,l).join("/")],s&&(s=s[n])){r=s,a=c;break}if(r)break;!h&&y&&y[n]&&(h=y[n],u=c)}!r&&h&&(r=h,a=u),r&&(i.splice(0,a,r),t=i.join("/"))}return t}function o(t,e){return function(){return f.apply(n,w.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return r(e,t)}}function h(t){return function(e){g[t]=e}}function u(t){if(s(m,t)){var e=m[t];delete m[t],_[t]=!0,p.apply(n,e)}if(!s(g,t)&&!s(_,t))throw new Error("No "+t);return g[t]}function c(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,f,d,y,g={},m={},v={},_={},S=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;d=function(t,e){var i,n=c(t),s=n[0];return t=n[1],s&&(s=r(s,e),i=u(s)),s?t=i&&i.normalize?i.normalize(t,a(e)):r(t,e):(t=r(t,e),n=c(t),s=n[0],t=n[1],s&&(i=u(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},y={require:function(t){return o(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:l(t)}}},p=function(t,e,i,r){var a,c,l,p,f,v,S=[],w=typeof i;if(r=r||t,"undefined"===w||"function"===w){for(e=!e.length&&i.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(p=d(e[f],r),c=p.f,"require"===c)S[f]=y.require(t);else if("exports"===c)S[f]=y.exports(t),v=!0;else if("module"===c)a=S[f]=y.module(t);else if(s(g,c)||s(m,c)||s(_,c))S[f]=u(c);else{if(!p.p)throw new Error(t+" missing "+c);p.p.load(p.n,o(r,!0),h(c),{}),S[f]=g[c]}l=i?i.apply(g[t],S):void 0,t&&(a&&a.exports!==n&&a.exports!==g[t]?g[t]=a.exports:l===n&&v||(g[t]=l))}else t&&(g[t]=i)},t=e=f=function(t,e,i,s,r){if("string"==typeof t)return y[t]?y[t](e):u(d(t,e).f);if(!t.splice){if(v=t,v.deps&&f(v.deps,v.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=r),s?p(n,t,e,i):setTimeout(function(){p(n,t,e,i)},4),f},f.config=function(t){return f(t)},t._defined=g,i=function(t,e,i){e.splice||(i=e,e=[]),s(g,t)||s(m,t)||(m[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("famous/core/Entity",["require","exports","module"],function(t,e,i){function n(t){return a[t]}function s(t,e){a[t]=e}function r(t){var e=a.length;return s(e,t),e}function o(t){s(t,null)}var a=[];i.exports={register:r,unregister:o,get:n,set:s}}),i("famous/core/Transform",["require","exports","module"],function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function r(t){return 0>t?-1:1}var o={};o.precision=1e-6,o.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},o.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},o.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},o.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],s=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return o.thenMove(e,[i,n,s])},o.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},o.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},o.scale=function(t,e,i){return void 0===i&&(i=1),void 0===e&&(e=t),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},o.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},o.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},o.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},o.rotate=function(t,e,i){var n=Math.cos(t),s=Math.sin(t),r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),h=Math.sin(i),u=[r*a,n*h+s*o*a,s*h-n*o*a,0,-r*h,n*a-s*o*h,s*a+n*o*h,0,o,-s*r,n*r,0,0,0,0,1];return u},o.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),s=1-n,r=t[0]*t[0]*s,o=t[0]*t[1]*s,a=t[0]*t[2]*s,h=t[1]*t[1]*s,u=t[1]*t[2]*s,c=t[2]*t[2]*s,l=t[0]*i,p=t[1]*i,f=t[2]*i,d=[r+n,o+f,a-p,0,o-f,h+n,u+l,0,a+p,u-l,c+n,0,0,0,0,1];return d},o.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),s=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return o.thenMove(e,[i,n,s])},o.skew=function(t,e,i){return[1,Math.tan(e),0,0,Math.tan(i),1,0,0,0,Math.tan(t),1,0,0,0,0,1]},o.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},o.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},o.getTranslate=function(t){return[t[12],t[13],t[14]]},o.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],r=t[0]*t[10]-t[2]*t[8],o=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],h=t[0]*t[6]-t[2]*t[4],u=t[0]*t[5]-t[1]*t[4],c=t[0]*e-t[1]*i+t[2]*n,l=1/c,p=[l*e,-l*s,l*a,0,-l*i,l*r,-l*h,0,l*n,-l*o,l*u,0,0,0,0,1];return p[12]=-t[12]*p[0]-t[13]*p[4]-t[14]*p[8],p[13]=-t[12]*p[1]-t[13]*p[5]-t[14]*p[9],p[14]=-t[12]*p[2]-t[13]*p[6]-t[14]*p[10],p},o.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},o.interpret=function(t){var e=[t[0],t[1],t[2]],i=r(e[0]),a=s(e),h=[e[0]+i*a,e[1],e[2]],u=2/n(h);if(u>=1/0)return{translate:o.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];c[0]=1-u*h[0]*h[0],c[5]=1-u*h[1]*h[1],c[10]=1-u*h[2]*h[2],c[1]=-u*h[0]*h[1],c[2]=-u*h[0]*h[2],c[6]=-u*h[1]*h[2],c[4]=c[1],c[8]=c[2],c[9]=c[6];var l=o.multiply(c,t),p=[l[5],l[6]],f=r(p[0]),d=s(p),y=[p[0]+f*d,p[1]],g=2/n(y),m=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];m[5]=1-g*y[0]*y[0],m[10]=1-g*y[1]*y[1],m[6]=-g*y[0]*y[1],m[9]=m[6];var v=o.multiply(m,c),_=o.multiply(v,t),S=o.scale(_[0]<0?-1:1,_[5]<0?-1:1,_[10]<0?-1:1);_=o.multiply(_,S),v=o.multiply(S,v);var w={};return w.translate=o.getTranslate(t),w.rotate=[Math.atan2(-v[6],v[10]),Math.asin(v[2]),Math.atan2(-v[1],v[0])],w.rotate[0]||(w.rotate[0]=0,w.rotate[2]=Math.atan2(v[4],v[5])),w.scale=[_[0],_[5],_[10]],w.skew=[Math.atan2(_[9],w.scale[2]),Math.atan2(_[8],w.scale[2]),Math.atan2(_[4],w.scale[0])],Math.abs(w.rotate[0])+Math.abs(w.rotate[2])>1.5*Math.PI&&(w.rotate[1]=Math.PI-w.rotate[1],w.rotate[1]>Math.PI&&(w.rotate[1]-=2*Math.PI),w.rotate[1]<-Math.PI&&(w.rotate[1]+=2*Math.PI),w.rotate[0]<0?w.rotate[0]+=Math.PI:w.rotate[0]-=Math.PI,w.rotate[2]<0?w.rotate[2]+=Math.PI:w.rotate[2]-=Math.PI),w},o.average=function(t,e,i){i=void 0===i?.5:i;for(var n=o.interpret(t),s=o.interpret(e),r={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)r.translate[a]=(1-i)*n.translate[a]+i*s.translate[a],r.rotate[a]=(1-i)*n.rotate[a]+i*s.rotate[a],r.scale[a]=(1-i)*n.scale[a]+i*s.scale[a],r.skew[a]=(1-i)*n.skew[a]+i*s.skew[a];return o.build(r)},o.build=function(t){var e=o.scale(t.scale[0],t.scale[1],t.scale[2]),i=o.skew(t.skew[0],t.skew[1],t.skew[2]),n=o.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return o.thenMove(o.multiply(o.multiply(n,i),e),t.translate)},o.equals=function(t,e){return!o.notEquals(t,e)},o.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},o.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},o.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],o.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=o}),i("famous/core/SpecParser",["require","exports","module","./Transform"],function(t,e,i){function n(){this.result={}}function s(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var r=t("./Transform");n._instance=new n,n.parse=function(t,e){return n._instance.parse(t,e)},n.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,r.identity),this.result},n.prototype.reset=function(){this.result={}};var o=[0,0];n.prototype._parseSpec=function(t,e,i){var n,a,h,u,c,l,p;if("number"==typeof t){if(n=t,h=e.transform,l=e.align||o,e.size&&l&&(l[0]||l[1])){var f=[l[0]*e.size[0],l[1]*e.size[1],0];h=r.thenMove(h,s(f,i))}this.result[n]={transform:h,opacity:e.opacity,origin:e.origin||o,align:e.align||o,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var d=0;d<t.length;d++)this._parseSpec(t[d],e,i);else{a=t.target,h=e.transform,u=e.opacity,c=e.origin,l=e.align,p=e.size;var y=i;if(void 0!==t.opacity&&(u=e.opacity*t.opacity),t.transform&&(h=r.multiply(e.transform,t.transform)),t.origin&&(c=t.origin,y=e.transform),t.align&&(l=t.align),t.size||t.proportions){var g=p;p=[p[0],p[1]],t.size&&(void 0!==t.size[0]&&(p[0]=t.size[0]),void 0!==t.size[1]&&(p[1]=t.size[1])),t.proportions&&(void 0!==t.proportions[0]&&(p[0]=p[0]*t.proportions[0]),void 0!==t.proportions[1]&&(p[1]=p[1]*t.proportions[1])),g&&(l&&(l[0]||l[1])&&(h=r.thenMove(h,s([l[0]*g[0],l[1]*g[1],0],i))),c&&(c[0]||c[1])&&(h=r.moveThen([-c[0]*p[0],-c[1]*p[1],0],h))),y=e.transform,c=null,l=null}this._parseSpec(a,{transform:h,opacity:u,origin:c,align:l,size:p},y)}}},i.exports=n}),i("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(t,e,i){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function s(t,e,i){for(var n=o.parse(t,e),a=Object.keys(n),h=0;h<a.length;h++){var u=a[h],c=r.get(u),l=n[u];l.allocator=e.allocator;var p=c.commit(l);p?s(p,e,i):i[u]=l}}var r=t("./Entity"),o=t("./SpecParser");n.prototype.add=function(t){var e=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),i=0;i<e.length;i++){var n=e[i];if(void 0===this._resultCache[n]){var o=r.get(n);o.cleanup&&o.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},s(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,i=0;i<e.length;i++)t[i]=e[i].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=n}),i("famous/core/EventEmitter",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var i=this.listeners[t];if(void 0!==i){var n=i.indexOf(e);n>=0&&i.splice(n,1)}return this},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),i("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,i){function n(){s.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var s=t("./EventEmitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=t.on,t.removeListener=e.removeListener.bind(e)},n.prototype.emit=function(t,e){s.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger&&this.downstream[i].trigger(t,e);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](t,e);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(s.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(t,e)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return this},n.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.removeListener(i,this.upstreamListeners[i])}return this},i.exports=n}),i("famous/core/ElementAllocator",["require","exports","module"],function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.firstChild);this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),i("famous/utilities/Utility",["require","exports","module"],function(t,e,i){var n={};n.Direction={X:0,Y:1,Z:2},n.after=function(t,e){var i=t;return function(){i--,0===i&&e.apply(this,arguments)}},n.loadURL=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()},n.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var i=document.createDocumentFragment();e.hasChildNodes();)i.appendChild(e.firstChild);return i},n.clone=function(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var i in t)if("object"==typeof t[i]&&null!==t[i])if(t[i]instanceof Array){e[i]=new Array(t[i].length);for(var s=0;s<t[i].length;s++)e[i][s]=n.clone(t[i][s])}else e[i]=n.clone(t[i]);else e[i]=t[i]}else e=t;return e},i.exports=n}),i("famous/transitions/MultipleTransition",["require","exports","module","../utilities/Utility"],function(t,e,i){function n(t){this.method=t,this._instances=[],this.state=[]}var s=t("../utilities/Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,e,i){for(var n=s.after(t.length,i),r=0;r<t.length;r++)this._instances[r]||(this._instances[r]=new this.method),this._instances[r].set(t[r],e,n)},n.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=n}),i("famous/transitions/TweenTransition",["require","exports","module"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function s(t,e,i){return(1-i)*t+i*e}function r(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function o(t,e){var i={curve:e.curve};return e.duration&&(i.duration=e.duration),e.speed&&(i.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(i.duration=t.duration),t.curve&&(i.curve=t.curve),t.speed&&(i.speed=t.speed)),"string"==typeof i.curve&&(i.curve=n.getCurve(i.curve)),i}function a(t,e,i,n,s){var r,o=1e-7,a=(i(s)-i(s-o))/o;if(t instanceof Array){r=[];for(var h=0;h<t.length;h++)r[h]="number"==typeof t[h]?a*(t[h]-e[h])/n:0}else r=a*(t-e)/n;return r}function h(t,e,i){var n;if(t instanceof Array){n=[];for(var r=0;r<t.length;r++)n[r]="number"==typeof t[r]?s(t[r],e[r],i):t[r]}else n=s(t,e,i);return n}n.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:n.Curves.linear,duration:500,speed:0};var u={};n.registerCurve=function(t,e){return u[t]?!1:(u[t]=e,!0)},n.unregisterCurve=function(t){return u[t]?(delete u[t],!0):!1},n.getCurve=function(t){var e=u[t];if(void 0!==e)return e;throw new Error("curve not registered")},n.getCurves=function(){return u},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),void(i&&i());if(this._startValue=r(this.get()),e=o(e,this.options),e.speed){var n=this._startValue;if(n instanceof Object){var s=0;for(var a in n)s+=(t[a]-n[a])*(t[a]-n[a]);e.duration=Math.sqrt(s)/e.speed}else e.duration=Math.abs(t-n)/e.speed}this._startTime=Date.now(),this._endValue=r(t),this._startVelocity=r(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=i},n.prototype.reset=function(t,e){if(this._callback){var i=this._callback;this._callback=void 0,i()}this.state=r(t),this.velocity=r(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},n.prototype.getVelocity=function(){return this.velocity},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var i=e/this._duration;this.state=h(this._startValue,this._endValue,this._curve(i)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,i)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",n.Curves.linear),n.registerCurve("easeIn",n.Curves.easeIn),n.registerCurve("easeOut",n.Curves.easeOut),n.registerCurve("easeInOut",n.Curves.easeInOut),n.registerCurve("easeOutBounce",n.Curves.easeOutBounce),n.registerCurve("spring",n.Curves.spring),n.customCurve=function(t,e){return t=t||0,e=e||0,function(i){return t*i+(-2*t-e+3)*i*i+(t+e-2)*i*i*i}},i.exports=n}),i("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(t,e,i){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function s(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,i=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(e=n.method,"string"==typeof e&&(e=a[e])):e=o,this._currentMethod!==e&&(this._engineInstance=!(i instanceof Object)||e.SUPPORTS_MULTIPLE===!0||i.length<=e.SUPPORTS_MULTIPLE?new e:new r(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(n.velocity=this.velocity),this._engineInstance.set(i,n,s.bind(this))}var r=t("./MultipleTransition"),o=t("./TweenTransition"),a={};n.register=function(t){var e=!0;for(var i in t)n.registerMethod(i,t[i])||(e=!1);return e},n.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),this;var n=[t,e];return this.actionQueue.push(n),this.callbackQueue.push(i),this.currentAction||s.call(this),this},n.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,e){this.set(this.get(),{duration:t,curve:function(){return 0}},e)},n.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){return this.set(this.get())},i.exports=n}),i("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","../transitions/Transitionable"],function(t,e,i){function n(t){return[t.clientWidth,t.clientHeight]}function s(t){this.container=t,this._allocator=new a(t),this._node=new r,this._eventOutput=new o,this._size=n(this.container),this._perspectiveState=new u(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:h.identity,opacity:1,origin:c,align:c,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n(this.container))}.bind(this))}var r=t("./RenderNode"),o=t("./EventHandler"),a=t("./ElementAllocator"),h=t("./Transform"),u=t("../transitions/Transitionable"),c=[0,0],l=!("perspective"in document.documentElement.style),p=l?function(t,e){t.style.webkitPerspective=e?e.toFixed()+"px":""}:function(t,e){t.style.perspective=e?e.toFixed()+"px":""};s.prototype.getAllocator=function(){return this._allocator},s.prototype.add=function(t){return this._node.add(t)},s.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},s.prototype.getSize=function(){return this._size},s.prototype.setSize=function(t){t||(t=n(this.container)),this._size[0]=t[0],this._size[1]=t[1]},s.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(p(this.container,e),this._perspective=e),this._node.commit(this._nodeContext)},s.prototype.getPerspective=function(){return this._perspectiveState.get()},s.prototype.setPerspective=function(t,e,i){return this._perspectiveState.set(t,e,i)},s.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},s.prototype.on=function(t,e){return this._eventOutput.on(t,e)},s.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},s.prototype.pipe=function(t){return this._eventOutput.pipe(t)},s.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=s}),i("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function s(){this.eventOutput=new r,this.eventOutput.bindThis(this),r.setOutputHandler(this,this.eventOutput)}var r=t("./EventHandler");n.patch=function(t){for(var e=new n(t),i=1;i<arguments.length;i++)e.patch(arguments[i]);return t},n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)n in t&&i[n]&&i[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,i[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return t?this._value[t]:this._value},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),i("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(t,e,i){function n(){z.runLoop?(d.step(),window.requestAnimationFrame(n)):w=!1}function s(){for(var t=0;t<y.length;t++)y[t].emit("resize");b.emit("resize")}function r(){window.addEventListener("touchmove",function(t){t.preventDefault()},!0),o()}function o(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void d.nextTick(o)}function a(t,e){return document.body?void document.body.addEventListener(t,e):void d.nextTick(addEventListener.bind(this,t,e))}function h(t,e){return document.body?(document.body.appendChild(e),void t.emit("resize")):void d.nextTick(h.bind(this,t,e))}var u,c,l=t("./Context"),p=t("./EventHandler"),f=t("./OptionsManager"),d={},y=[],g=[],m=0,v=0,_=[],S=Date.now(),w=!0,x={},b=new p,z={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},M=new f(z),T=10;d.step=function(){m++,v=m;var t=Date.now();if(!(c&&c>t-S)){var e=0;u=t-S,S=t,b.emit("prerender");for(var i=g.length;i--;)g.shift()(m);for(;_.length&&Date.now()-t<T;)_.shift().call(this);for(e=0;e<y.length;e++)y[e].update();b.emit("postrender")}},window.requestAnimationFrame(n),window.addEventListener("resize",s,!1),s();var O=!1;d.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(d):b.pipe(t)},d.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(d):b.unpipe(t)},d.on=function(t,e){return t in x||(x[t]=b.emit.bind(b,t),a(t,x[t])),b.on(t,e)},d.emit=function(t,e){return b.emit(t,e)},d.removeListener=function(t,e){return b.removeListener(t,e)},d.getFPS=function(){return 1e3/u},d.setFPSCap=function(t){c=Math.floor(1e3/t)},d.getOptions=function(t){return M.getOptions(t)},d.setOptions=function(){return M.setOptions.apply(M,arguments)},d.createContext=function(t){!O&&z.appMode&&d.nextTick(r);var e=!1;t||(t=document.createElement(z.containerType),t.classList.add(z.containerClass),e=!0);var i=new l(t);return d.registerContext(i),e&&h(i,t),i},d.registerContext=function(t){return y.push(t),t},d.getContexts=function(){return y},d.deregisterContext=function(t){var e=y.indexOf(t);e>=0&&y.splice(e,1)},d.nextTick=function(t){g.push(t)},d.defer=function(t){_.push(t)},M.on("change",function(t){"fpsCap"===t.id?d.setFPSCap(t.value):"runLoop"===t.id&&!w&&t.value&&(w=!0,window.requestAnimationFrame(n))}),i.exports=d}),i("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","../core/Transform","../utilities/Utility"],function(t,e,i){function n(t){this._final=a.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new o(this._finalTranslate),this.rotate=new o(this._finalRotate),this.skew=new o(this._finalSkew),this.scale=new o(this._finalScale),t&&this.set(t)}function s(){return a.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function r(){return a.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var o=t("./Transitionable"),a=t("../core/Transform"),h=t("../utilities/Utility");n.prototype.setTranslate=function(t,e,i){return this._finalTranslate=t,this._final=r.call(this),this.translate.set(t,e,i),this},n.prototype.setScale=function(t,e,i){return this._finalScale=t,this._final=r.call(this),this.scale.set(t,e,i),this},n.prototype.setRotate=function(t,e,i){return this._finalRotate=t,this._final=r.call(this),this.rotate.set(t,e,i),this},n.prototype.setSkew=function(t,e,i){return this._finalSkew=t,this._final=r.call(this),this.skew.set(t,e,i),this},n.prototype.set=function(t,e,i){var n=a.interpret(t);this._finalTranslate=n.translate,this._finalRotate=n.rotate,this._finalSkew=n.skew,this._finalScale=n.scale,this._final=t;var s=i?h.after(4,i):null;return this.translate.set(n.translate,e,s),this.rotate.set(n.rotate,e,s),this.skew.set(n.skew,e,s),this.scale.set(n.scale,e,s),this},n.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)
},n.prototype.get=function(){return this.isActive()?s.call(this):this._final},n.prototype.getFinal=function(){return this._final},n.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},n.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},i.exports=n}),i("famous/core/Modifier",["require","exports","module","./Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:r.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size),t.proportions&&this.proportionsFrom(t.proportions))}function s(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var r=t("./Transform"),o=t("../transitions/Transitionable"),a=t("../transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.proportionsFrom=function(t){return t instanceof Function?this._proportionGetter=t:t instanceof Object&&t.get?this._proportionGetter=t.get.bind(t):(this._proportionGetter=null,this._output.proportions=t),this},n.prototype.setTransform=function(t,e,i){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,i),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,e,i){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new o(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,i)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,e,i){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new o(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,i),this):this.originFrom(t)},n.prototype.setAlign=function(t,e,i){return e||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new o(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,e,i),this):this.alignFrom(t)},n.prototype.setSize=function(t,e,i){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new o(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,i),this):this.sizeFrom(t)},n.prototype.setProportions=function(t,e,i){return t&&(e||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new o(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(t,e,i),this):this.proportionsFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getAlign=function(){return this._alignGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},n.prototype.modify=function(t){return s.call(this),this._output.target=t,this._output},i.exports=n}),i("famous/core/ElementOutput",["require","exports","module","./Entity","./EventHandler","./Transform"],function(t,e,i){function n(t){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new c,this._eventOutput.bindThis(this),this.eventForwarder=function(t){this._eventOutput.emit(t.type,t)}.bind(this),this.id=u.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,t&&this.attach(t)}function s(t){for(var e in this._eventOutput.listeners)t.addEventListener(e,this.eventForwarder)}function r(t){for(var e in this._eventOutput.listeners)t.removeEventListener(e,this.eventForwarder)}function o(t){t[12]=Math.round(t[12]*f)/f,t[13]=Math.round(t[13]*f)/f;for(var e="matrix3d(",i=0;15>i;i++)e+=t[i]<1e-6&&t[i]>-1e-6?"0,":t[i]+",";return e+=t[15]+")"}function a(t){return 100*t[0]+"% "+100*t[1]+"%"}function h(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var u=t("./Entity"),c=t("./EventHandler"),l=t("./Transform"),p=!("transform"in document.documentElement.style),f=window.devicePixelRatio||1;n.prototype.on=function(t,e){this._element&&this._element.addEventListener(t,this.eventForwarder),this._eventOutput.on(t,e)},n.prototype.removeListener=function(t,e){this._eventOutput.removeListener(t,e)},n.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this._eventOutput.emit(t,e);return i&&e&&e.stopPropagation&&e.stopPropagation(),i},n.prototype.pipe=function(t){return this._eventOutput.pipe(t)},n.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},n.prototype.render=function(){return this.id};var d;d=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,e){t.style.zIndex=1e6*e[14]|0,t.style.transform=o(e)}:p?function(t,e){t.style.webkitTransform=o(e)}:function(t,e){t.style.transform=o(e)};var y=p?function(t,e){t.style.webkitTransformOrigin=a(e)}:function(t,e){t.style.transformOrigin=a(e)},g=p?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0};n.prototype.commit=function(t){var e=this._element;if(e){{var i=t.transform,n=t.opacity,s=t.origin;t.size}if(!i&&this._matrix)return this._matrix=null,this._opacity=0,void g(e);if(h(this._origin,s)&&(this._originDirty=!0),l.notEquals(this._matrix,i)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==n&&(this._opacity=n,e.style.opacity=n>=1?"0.999999":n),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(s?(this._origin||(this._origin=[0,0]),this._origin[0]=s[0],this._origin[1]=s[1]):this._origin=null,y(e,this._origin),this._originDirty=!1),i||(i=l.identity),this._matrix=i;var r=this._size?l.thenMove(i,[-this._size[0]*s[0],-this._size[1]*s[1],0]):i;d(e,r),this._transformDirty=!1}}},n.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},n.prototype.attach=function(t){this._element=t,s.call(this,t)},n.prototype.detach=function(){var t=this._element;return t&&(r.call(this,t),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,t},i.exports=n}),i("famous/core/Surface",["require","exports","module","./ElementOutput"],function(t,e,i){function n(t){c.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],t&&this.setOptions(t),this._currentTarget=null}function s(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function r(t){for(var e in this.properties)t.style[e]=this.properties[e]}function o(t){for(var e in this.properties)t.style[e]=""}function a(t){for(var e in this.attributes)t.setAttribute(e,this.attributes[e])}function h(t){for(var e in this.attributes)t.removeAttribute(e)}function u(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var c=t("./ElementOutput");n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.setAttributes=function(t){for(var e in t){if("style"===e)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[e]=t[e]}this._attributesDirty=!0},n.prototype.getAttributes=function(){return this.attributes},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];return this._stylesDirty=!0,this},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){return this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0),this},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);return e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0),this},n.prototype.toggleClass=function(t){var e=this.classList.indexOf(t);return e>=0?this.removeClass(t):this.addClass(t),this},n.prototype.setClasses=function(t){var e=0,i=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&i.push(this.classList[e]);for(e=0;e<i.length;e++)this.removeClass(i[e]);for(e=0;e<t.length;e++)this.addClass(t[e]);return this},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){return this.content!==t&&(this.content=t,this._contentDirty=!0),this},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){return t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.attributes&&this.setAttributes(t.attributes),t.content&&this.setContent(t.content),this},n.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);e.style.display="",this.attach(e),this._opacity=null,this._currentTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},n.prototype.commit=function(t){this._currentTarget||this.setup(t.allocator);var e=this._currentTarget,i=t.size;if(this._classesDirty){s.call(this,e);for(var n=this.getClassList(),o=0;o<n.length;o++)e.classList.add(n[o]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(r.call(this,e),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(a.call(this,e),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var h=t.size;if(i=[this.size[0],this.size[1]],void 0===i[0]&&(i[0]=h[0]),void 0===i[1]&&(i[1]=h[1]),i[0]===!0||i[1]===!0){if(i[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=e.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),i[0]=l}else this._size&&(i[0]=this._size[0]);if(i[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var p=e.offsetHeight;this._size&&this._size[1]!==p&&(this._size[1]=p,this._sizeDirty=!0),i[1]=p}else this._size&&(i[1]=this._size[1]);this._trueSizeCheck=!1}}u(this._size,i)&&(this._size||(this._size=[0,0]),this._size[0]=i[0],this._size[1]=i[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(e.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",e.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(e),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),c.prototype.commit.call(this,t)},n.prototype.cleanup=function(t){var e=0,i=this._currentTarget;this._eventOutput.emit("recall"),this.recall(i),i.style.display="none",i.style.opacity="",i.style.width="",i.style.height="",o.call(this,i),h.call(this,i);var n=this.getClassList();for(s.call(this,i),e=0;e<n.length;e++)i.classList.remove(n[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)i.classList.remove(this.elementClass[e]);else i.classList.remove(this.elementClass);this.detach(i),this._currentTarget=null,t.deallocate(i)},n.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},n.prototype.getSize=function(){return this._size?this._size:this.size},n.prototype.setSize=function(t){return this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0,this},i.exports=n}),i("famous/surfaces/ImageSurface",["require","exports","module","../core/Surface"],function(t,e,i){function n(){this._imageUrl=void 0,s.apply(this,arguments)}var s=t("../core/Surface"),r=[],o=[],a=[],h=!0;n.enableCache=function(){h=!0},n.disableCache=function(){h=!1},n.clearCache=function(){r=[],o=[],a=[]},n.getCache=function(){return{urlCache:r,countCache:o,nodeCache:o}},n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="img",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(t){var e=r.indexOf(this._imageUrl);-1!==e&&(1===o[e]?(r.splice(e,1),o.splice(e,1),a.splice(e,1)):o[e]--),e=r.indexOf(t),-1===e?(r.push(t),o.push(1)):o[e]++,this._imageUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){var e=r.indexOf(this._imageUrl);if(void 0===a[e]&&h){var i=new Image;i.src=this._imageUrl||"",a[e]=i}t.src=this._imageUrl||""},n.prototype.recall=function(t){t.src=""},i.exports=n}),i("famous/modifiers/StateModifier",["require","exports","module","../core/Modifier","../core/Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformState=new a(r.identity),this._opacityState=new o(1),this._originState=new o([0,0]),this._alignState=new o([0,0]),this._sizeState=new o([0,0]),this._proportionsState=new o([0,0]),this._modifier=new s({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.align&&this.setAlign(t.align),t.size&&this.setSize(t.size),t.proportions&&this.setProportions(t.proportions))}var s=t("../core/Modifier"),r=t("../core/Transform"),o=t("../transitions/Transitionable"),a=t("../transitions/TransitionableTransform");n.prototype.setTransform=function(t,e,i){return this._transformState.set(t,e,i),this},n.prototype.setOpacity=function(t,e,i){return this._opacityState.set(t,e,i),this},n.prototype.setOrigin=function(t,e,i){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,e,i),this)},n.prototype.setAlign=function(t,e,i){return null===t?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(t,e,i),this)},n.prototype.setSize=function(t,e,i){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,e,i),this)},n.prototype.setProportions=function(t,e,i){return null===t?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(t,e,i),this)},n.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},n.prototype.getTransform=function(){return this._transformState.get()},n.prototype.getFinalTransform=function(){return this._transformState.getFinal()},n.prototype.getOpacity=function(){return this._opacityState.get()},n.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},n.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},n.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},n.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},n.prototype.modify=function(t){return this._modifier.modify(t)},i.exports=n}),i("famous/physics/PhysicsEngine",["require","exports","module","../core/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=x(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function s(t){return t.applyForce?this._forces:t.applyConstraint?this._constraints:void 0}function r(t,e,i){return void 0===e&&(e=this.getParticlesAndBodies()),e instanceof Array||(e=[e]),t.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:t,id:this._currAgentId,targets:e,source:i},s.call(this,t).push(this._currAgentId),this._currAgentId++}function o(t){return this._agentData[t]}function a(t){var e=o.call(this,this._forces[t]);e.agent.applyForce(e.targets,e.source)}function h(){for(var t=this._forces.length-1;t>-1;t--)a.call(this,t)}function u(t,e){var i=this._agentData[this._constraints[t]];return i.agent.applyConstraint(i.targets,i.source,e)}function c(t){for(var e=0;e<this.options.constraintSteps;){for(var i=this._constraints.length-1;i>-1;i--)u.call(this,i,t);e++}}function l(t,e){t.integrateVelocity(e),this.options.velocityCap&&t.velocity.cap(this.options.velocityCap).put(t.velocity)}function p(t,e){t.integrateAngularMomentum(e),t.updateAngularVelocity(),this.options.angularVelocityCap&&t.angularVelocity.cap(this.options.angularVelocityCap).put(t.angularVelocity)}function f(t,e){t.integrateOrientation(e)}function d(t,e){t.integratePosition(e),t.emit(b.update,t)}function y(t){h.call(this,t),this.forEach(l,t),this.forEachBody(p,t),c.call(this,t),this.forEachBody(f,t),this.forEach(d,t)}function g(){var t=0,e=0;return this.forEach(function(i){e=i.getEnergy(),t+=e}),t}function m(){var t=0;for(var e in this._agentData)t+=this.getAgentEnergy(e);return t}var v=t("../core/EventHandler"),_=17,S=1e3/120,w=17,x=Date.now,b={start:"start",update:"update",end:"end"};n.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},n.prototype.setOptions=function(t){for(var e in t)this.options[e]&&(this.options[e]=t[e])},n.prototype.addBody=function(t){return t._engine=this,t.isBody?(this._bodies.push(t),this._hasBodies=!0):this._particles.push(t),t.on("start",this.wake.bind(this)),t},n.prototype.removeBody=function(t){var e=t.isBody?this._bodies:this._particles,i=e.indexOf(t);if(i>-1){for(var n in this._agentData)this._agentData.hasOwnProperty(n)&&this.detachFrom(this._agentData[n].id,t);e.splice(i,1)}0===this.getBodies().length&&(this._hasBodies=!1)},n.prototype.attach=function(t,e,i){if(this.wake(),t instanceof Array){for(var n=[],s=0;s<t.length;s++)n[s]=r.call(this,t[s],e,i);return n}return r.call(this,t,e,i)},n.prototype.attachTo=function(t,e){o.call(this,t).targets.push(e)},n.prototype.detach=function(t){var e=this.getAgent(t),i=s.call(this,e),n=i.indexOf(t);i.splice(n,1),delete this._agentData[t]},n.prototype.detachFrom=function(t,e){var i=o.call(this,t);if(i.source===e)this.detach(t);else{var n=i.targets,s=n.indexOf(e);s>-1&&n.splice(s,1)}},n.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},n.prototype.getAgent=function(t){return o.call(this,t).agent},n.prototype.getParticles=function(){return this._particles},n.prototype.getBodies=function(){return this._bodies},n.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},n.prototype.forEachParticle=function(t,e){for(var i=this.getParticles(),n=0,s=i.length;s>n;n++)t.call(this,i[n],e)},n.prototype.forEachBody=function(t,e){if(this._hasBodies)for(var i=this.getBodies(),n=0,s=i.length;s>n;n++)t.call(this,i[n],e)},n.prototype.forEach=function(t,e){this.forEachParticle(t,e),this.forEachBody(t,e)},n.prototype.getAgentEnergy=function(t){var e=o.call(this,t);return e.agent.getEnergy(e.targets,e.source)},n.prototype.getEnergy=function(){return g.call(this)+m.call(this)},n.prototype.step=function(){if(!this.isSleeping()){var t=x(),e=t-this._prevTime;this._prevTime=t,S>e||(e>w&&(e=w),y.call(this,_),this.emit(b.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},n.prototype.isSleeping=function(){return this._isSleeping},n.prototype.isActive=function(){return!this._isSleeping},n.prototype.sleep=function(){this._isSleeping||(this.forEach(function(t){t.sleep()}),this.emit(b.end,this),this._isSleeping=!0)},n.prototype.wake=function(){this._isSleeping&&(this._prevTime=x(),this.emit(b.start,this),this._isSleeping=!1)},n.prototype.emit=function(t,e){null!==this._eventHandler&&this._eventHandler.emit(t,e)},n.prototype.on=function(t,e){null===this._eventHandler&&(this._eventHandler=new v),this._eventHandler.on(t,e)},i.exports=n}),i("famous/physics/constraints/Constraint",["require","exports","module","../../core/EventHandler"],function(t,e,i){function n(){this.options=this.options||{},this._eventOutput=new s,s.setOutputHandler(this,this._eventOutput)}var s=t("../../core/EventHandler");n.prototype.setOptions=function(t){this._eventOutput.emit("change",t)},n.prototype.applyConstraint=function(){},n.prototype.getEnergy=function(){return 0},i.exports=n}),i("famous/math/Vector",["require","exports","module"],function(t,e,i){function n(t,e,i){return 1===arguments.length&&void 0!==t?this.set(t):(this.x=t||0,this.y=e||0,this.z=i||0),this}function s(t,e,i){return this.x=t,this.y=e,this.z=i,this}function r(t){return s.call(this,t[0],t[1],t[2]||0)}function o(t){return s.call(this,t.x,t.y,t.z)}function a(t){return s.call(this,t,0,0)}var h=new n(0,0,0);n.prototype.add=function(t){return s.call(h,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t){return s.call(h,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t){return s.call(h,t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t){return this.mult(1/t)},n.prototype.cross=function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z;return s.call(h,n*o-i*a,e*a-n*r,i*r-e*o)},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},n.prototype.rotateX=function(t){var e=this.x,i=this.y,n=this.z,r=Math.cos(t),o=Math.sin(t);return s.call(h,e,i*r-n*o,i*o+n*r)},n.prototype.rotateY=function(t){var e=this.x,i=this.y,n=this.z,r=Math.cos(t),o=Math.sin(t);return s.call(h,n*o+e*r,i,n*r-e*o)},n.prototype.rotateZ=function(t){var e=this.x,i=this.y,n=this.z,r=Math.cos(t),o=Math.sin(t);return s.call(h,e*r-i*o,e*o+i*r,n)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t){0===arguments.length&&(t=1);var e=this.norm();return e>1e-7?o.call(h,this.mult(t/e)):s.call(h,t,0,0)},n.prototype.clone=function(){return new n(this)},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.set=function(t){return t instanceof Array?r.call(this,t):"number"==typeof t?a.call(this,t):o.call(this,t)},n.prototype.setXYZ=function(){return s.apply(this,arguments)},n.prototype.set1D=function(t){return a.call(this,t)},n.prototype.put=function(t){this===h?o.call(t,h):o.call(t,this)},n.prototype.clear=function(){return s.call(this,0,0,0)},n.prototype.cap=function u(u){if(1/0===u)return o.call(h,this);var t=this.norm();return t>u?o.call(h,this.mult(u/t)):o.call(h,this)},n.prototype.project=function(t){return t.mult(this.dot(t))},n.prototype.reflectAcross=function(t){return t.normalize().put(t),o(h,this.sub(this.project(t).mult(2)))},n.prototype.get=function(){return[this.x,this.y,this.z]},n.prototype.get1D=function(){return this.x},i.exports=n}),i("famous/physics/constraints/Collision",["require","exports","module","./Constraint","../../math/Vector"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.normal=new r,this.pDiff=new r,this.vDiff=new r,this.impulse1=new r,this.impulse2=new r,s.call(this)}var s=t("./Constraint"),r=t("../../math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},n.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){if(void 0!==e)for(var n=e.velocity,s=e.position,r=e.inverseMass,o=e.radius,a=this.options,h=a.drift,u=-a.slop,c=a.restitution,l=this.normal,p=this.pDiff,f=this.vDiff,d=this.impulse1,y=this.impulse2,g=0;g<t.length;g++){var m=t[g];if(m!==e){var v=m.velocity,_=m.position,S=m.inverseMass,w=m.radius;p.set(_.sub(s)),f.set(v.sub(n));var x=p.norm(),b=x-(o+w),z=1/(r+S),M=0;if(0>b){if(l.set(p.normalize()),this._eventOutput){var T={target:m,source:e,overlap:b,normal:l};this._eventOutput.emit("preCollision",T),this._eventOutput.emit("collision",T)}var O=u>=b?((1+c)*l.dot(f)+h/i*(b-u))/(M+i/z):(1+c)*l.dot(f)/(M+i/z);l.mult(i*O).put(d),d.mult(-1).put(y),e.applyImpulse(d),m.applyImpulse(y),this._eventOutput&&this._eventOutput.emit("postCollision",T)}}}},i.exports=n}),i("famous/physics/integrators/SymplecticEuler",["require","exports","module"],function(t,e,i){var n={};n.integrateVelocity=function(t,e){var i=t.velocity,n=t.inverseMass,s=t.force;s.isZero()||(i.add(s.mult(e*n)).put(i),s.clear())},n.integratePosition=function(t,e){var i=t.position,n=t.velocity;i.add(n.mult(e)).put(i)},n.integrateAngularMomentum=function(t,e){var i=t.angularMomentum,n=t.torque;n.isZero()||(i.add(n.mult(e)).put(i),n.clear())},n.integrateOrientation=function(t,e){var i=t.orientation,n=t.angularVelocity;n.isZero()||i.add(i.multiply(n).scalarMultiply(.5*e)).put(i)},i.exports=n}),i("famous/physics/bodies/Particle",["require","exports","module","../../math/Vector","../../core/Transform","../../core/EventHandler","../integrators/SymplecticEuler"],function(t,e,i){function n(t){t=t||{};var e=n.DEFAULT_OPTIONS;this.position=new r,this.velocity=new r,this.force=new r,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==t.mass?t.mass:e.mass,this.inverseMass=1/this.mass,this.setPosition(t.position||e.position),this.setVelocity(t.velocity||e.velocity),this.force.set(t.force||[0,0,0]),this.transform=o.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function s(){this._eventOutput=new a,this._eventOutput.bindThis(this),a.setOutputHandler(this,this._eventOutput)}var r=t("../../math/Vector"),o=t("../../core/Transform"),a=t("../../core/EventHandler"),h=t("../integrators/SymplecticEuler");n.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var u={start:"start",update:"update",end:"end"},c=Date.now;n.prototype.isBody=!1,n.prototype.isActive=function(){return!this._isSleeping},n.prototype.sleep=function(){this._isSleeping||(this.emit(u.end,this),this._isSleeping=!0)},n.prototype.wake=function(){this._isSleeping&&(this.emit(u.start,this),this._isSleeping=!1,this._prevTime=c(),this._engine&&this._engine.wake())},n.prototype.setPosition=function(t){this.position.set(t)},n.prototype.setPosition1D=function(t){this.position.x=t},n.prototype.getPosition=function(){return this._engine.step(),this.position.get()},n.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},n.prototype.setVelocity=function(t){this.velocity.set(t),(0!==t[0]||0!==t[1]||0!==t[2])&&this.wake()},n.prototype.setVelocity1D=function(t){this.velocity.x=t,0!==t&&this.wake()},n.prototype.getVelocity=function(){return this.velocity.get()},n.prototype.setForce=function(t){this.force.set(t),this.wake()},n.prototype.getVelocity1D=function(){return this.velocity.x},n.prototype.setMass=function(t){this.mass=t,this.inverseMass=1/t},n.prototype.getMass=function(){return this.mass},n.prototype.reset=function(t,e){this.setPosition(t||[0,0,0]),this.setVelocity(e||[0,0,0])},n.prototype.applyForce=function(t){t.isZero()||(this.force.add(t).put(this.force),this.wake())},n.prototype.applyImpulse=function(t){if(!t.isZero()){var e=this.velocity;e.add(t.mult(this.inverseMass)).put(e)}},n.prototype.integrateVelocity=function(t){h.integrateVelocity(this,t)},n.prototype.integratePosition=function(t){h.integratePosition(this,t)},n.prototype._integrate=function(t){this.integrateVelocity(t),this.integratePosition(t)},n.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},n.prototype.getTransform=function(){this._engine.step();var t=this.position,e=this.transform;return e[12]=t.x,e[13]=t.y,e[14]=t.z,e},n.prototype.modify=function(t){var e=this._spec.target;return e.transform=this.getTransform(),e.target=t,this._spec},n.prototype.emit=function(t,e){this._eventOutput&&this._eventOutput.emit(t,e)},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),i("famous/math/Matrix",["require","exports","module","./Vector"],function(t,e,i){function n(t){return this.values=t||[[1,0,0],[0,1,0],[0,0,1]],this
}var s=t("./Vector"),r=new n,o=new s;n.prototype.get=function(){return this.values},n.prototype.set=function(t){this.values=t},n.prototype.vectorMultiply=function(t){var e=this.get(),i=t.x,n=t.y,s=t.z,r=e[0],a=e[1],h=e[2],u=r[0],c=r[1],l=r[2],p=a[0],f=a[1],d=a[2],y=h[0],g=h[1],m=h[2];return o.setXYZ(u*i+c*n+l*s,p*i+f*n+d*s,y*i+g*n+m*s)},n.prototype.multiply=function(t){for(var e=this.get(),i=[[]],n=0;3>n;n++){i[n]=[];for(var s=0;3>s;s++){for(var o=0,a=0;3>a;a++)o+=e[n][a]*t[a][s];i[n][s]=o}}return r.set(i)},n.prototype.transpose=function(){for(var t=[],e=this.get(),i=0;3>i;i++)for(var n=0;3>n;n++)t[i][n]=e[n][i];return r.set(t)},n.prototype.clone=function(){for(var t=this.get(),e=[],i=0;3>i;i++)e[i]=t[i].slice();return new n(e)},i.exports=n}),i("famous/math/Quaternion",["require","exports","module","./Matrix"],function(t,e,i){function n(t,e,i,n){return 1===arguments.length?this.set(t):(this.w=void 0!==t?t:1,this.x=void 0!==e?e:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0),this}var s=t("./Matrix"),r=new n(1,0,0,0);n.prototype.add=function(t){return r.setWXYZ(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t){return r.setWXYZ(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.scalarDivide=function(t){return this.scalarMultiply(1/t)},n.prototype.scalarMultiply=function(t){return r.setWXYZ(this.w*t,this.x*t,this.y*t,this.z*t)},n.prototype.multiply=function(t){var e=this.x,i=this.y,n=this.z,s=this.w,o=t.x,a=t.y,h=t.z,u=t.w||0;return r.setWXYZ(s*u-e*o-i*a-n*h,e*u+o*s+a*n-i*h,i*u+a*s+e*h-o*n,n*u+h*s+o*i-e*a)};var o=new n(1,0,0,0);n.prototype.rotateVector=function(t){return o.set(this.conj()),r.set(this.multiply(t).multiply(o))},n.prototype.inverse=function(){return r.set(this.conj().scalarDivide(this.normSquared()))},n.prototype.negate=function(){return this.scalarMultiply(-1)},n.prototype.conj=function(){return r.setWXYZ(this.w,-this.x,-this.y,-this.z)},n.prototype.normalize=function(t){return t=void 0===t?1:t,this.scalarDivide(t*this.norm())},n.prototype.makeFromAngleAndAxis=function(t,e){var i=e.normalize(),n=.5*t,s=-Math.sin(n);return this.x=s*i.x,this.y=s*i.y,this.z=s*i.z,this.w=Math.cos(n),this},n.prototype.setWXYZ=function(t,e,i,n){return r.clear(),this.w=t,this.x=e,this.y=i,this.z=n,this},n.prototype.set=function(t){return t instanceof Array?(this.w=0,this.x=t[0],this.y=t[1],this.z=t[2]):(this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z),this!==r&&r.clear(),this},n.prototype.put=function(t){t.set(r)},n.prototype.clone=function(){return new n(this)},n.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},n.prototype.isEqual=function(t){return t.w===this.w&&t.x===this.x&&t.y===this.y&&t.z===this.z},n.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.getTransform=function(){var t=this.normalize(1),e=t.x,i=t.y,n=t.z,s=t.w;return[1-2*i*i-2*n*n,2*e*i-2*n*s,2*e*n+2*i*s,0,2*e*i+2*n*s,1-2*e*e-2*n*n,2*i*n-2*e*s,0,2*e*n-2*i*s,2*i*n+2*e*s,1-2*e*e-2*i*i,0,0,0,0,1]};var a=new s;n.prototype.getMatrix=function(){var t=this.normalize(1),e=t.x,i=t.y,n=t.z,s=t.w;return a.set([[1-2*i*i-2*n*n,2*e*i+2*n*s,2*e*n-2*i*s],[2*e*i-2*n*s,1-2*e*e-2*n*n,2*i*n+2*e*s],[2*e*n+2*i*s,2*i*n-2*e*s,1-2*e*e-2*i*i]])};var h=1e-5;n.prototype.slerp=function(t,e){var i,n,s,o,a;return n=this.dot(t),1-n>h?(i=Math.acos(n),s=Math.sin(i),o=Math.sin((1-e)*i)/s,a=Math.sin(e*i)/s):(o=1-e,a=e),r.set(this.scalarMultiply(o/a).add(t).multiply(a))},i.exports=n}),i("famous/physics/bodies/Body",["require","exports","module","./Particle","../../core/Transform","../../math/Vector","../../math/Quaternion","../../math/Matrix","../integrators/SymplecticEuler"],function(t,e,i){function n(t){s.call(this,t),t=t||{},this.orientation=new a,this.angularVelocity=new o,this.angularMomentum=new o,this.torque=new o,t.orientation&&this.orientation.set(t.orientation),t.angularVelocity&&this.angularVelocity.set(t.angularVelocity),t.angularMomentum&&this.angularMomentum.set(t.angularMomentum),t.torque&&this.torque.set(t.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new o}var s=t("./Particle"),r=t("../../core/Transform"),o=t("../../math/Vector"),a=t("../../math/Quaternion"),h=t("../../math/Matrix"),u=t("../integrators/SymplecticEuler");n.DEFAULT_OPTIONS=s.DEFAULT_OPTIONS,n.DEFAULT_OPTIONS.orientation=[0,0,0,1],n.DEFAULT_OPTIONS.angularVelocity=[0,0,0],n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.isBody=!0,n.prototype.setMass=function(){s.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},n.prototype.setMomentsOfInertia=function(){this.inertia=new h,this.inverseInertia=new h},n.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},n.prototype.toWorldCoordinates=function(t){return this.pWorld.set(this.orientation.rotateVector(t))},n.prototype.getEnergy=function(){return s.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},n.prototype.reset=function(t,e,i,n){s.prototype.reset.call(this,t,e),this.angularVelocity.clear(),this.setOrientation(i||[1,0,0,0]),this.setAngularMomentum(n||[0,0,0])},n.prototype.setOrientation=function(t){this.orientation.set(t)},n.prototype.setAngularVelocity=function(t){this.wake(),this.angularVelocity.set(t)},n.prototype.setAngularMomentum=function(t){this.wake(),this.angularMomentum.set(t)},n.prototype.applyForce=function(t,e){s.prototype.applyForce.call(this,t),void 0!==e&&this.applyTorque(e.cross(t))},n.prototype.applyTorque=function(t){this.wake(),this.torque.set(this.torque.add(t))},n.prototype.getTransform=function(){return r.thenMove(this.orientation.getTransform(),r.getTranslate(s.prototype.getTransform.call(this)))},n.prototype._integrate=function(t){s.prototype._integrate.call(this,t),this.integrateAngularMomentum(t),this.updateAngularVelocity(t),this.integrateOrientation(t)},n.prototype.integrateAngularMomentum=function(t){u.integrateAngularMomentum(this,t)},n.prototype.integrateOrientation=function(t){u.integrateOrientation(this,t)},i.exports=n}),i("famous/physics/bodies/Circle",["require","exports","module","./Body","../../math/Matrix"],function(t,e,i){function n(t){t=t||{},this.setRadius(t.radius||0),s.call(this,t)}var s=t("./Body"),r=t("../../math/Matrix");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.setRadius=function(t){this.radius=t,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},n.prototype.setMomentsOfInertia=function(){var t=this.mass,e=this.radius;this.inertia=new r([[.25*t*e*e,0,0],[0,.25*t*e*e,0],[0,0,.5*t*e*e]]),this.inverseInertia=new r([[4/(t*e*e),0,0],[0,4/(t*e*e),0],[0,0,2/(t*e*e)]])},i.exports=n}),i("famous/utilities/Timer",["require","exports","module","../core/Engine"],function(t,e,i){function n(t){return c.on(l,t),t}function s(t,e){var i=p(),s=function(){var n=p();n-i>=e&&(t.apply(this,arguments),c.removeListener(l,s))};return n(s)}function r(t,e){var i=p(),s=function(){var n=p();n-i>=e&&(t.apply(this,arguments),i=p())};return n(s)}function o(t,e){if(void 0===e)return void 0;var i=function(){e--,0>=e&&(t.apply(this,arguments),h(i))};return n(i)}function a(t,e){e=e||1;var i=e,s=function(){e--,0>=e&&(t.apply(this,arguments),e=i)};return n(s)}function h(t){c.removeListener(l,t)}function u(t,e){var i,n,r,o,a;return function(){n=this,a=arguments,r=p();var u=function(){var h=p-r;e>h?i=s(u,e-h):(i=null,o=t.apply(n,a))};return h(i),i=s(u,e),o}}var c=t("../core/Engine"),l="prerender",p=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};i.exports={setTimeout:s,setInterval:r,debounce:u,after:o,every:a,clear:h}}),i("famous/math/Random",["require","exports","module"],function(t,e,i){function n(t,e){return t+r()*(e-t)}function s(t,e){return t+r()*(e-t+1)>>0}var r=Math.random,o={};o.integer=function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var n=[],r=0;i>r;r++)n.push(s(t,e));return n}return s(t,e)},o.range=function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var s=[],r=0;i>r;r++)s.push(n(t,e));return s}return n(t,e)},o.sign=function(t){return t=void 0!==t?t:.5,r()<t?1:-1},o.bool=function(t){return t=void 0!==t?t:.5,r()<t},i.exports=o}),i("famous/surfaces/CanvasSurface",["require","exports","module","../core/Surface"],function(t,e,i){function n(t){t&&t.canvasSize&&(this._canvasSize=t.canvasSize),s.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var s=t("../core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="canvas",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(){},n.prototype.deploy=function(t){this._canvasSize&&(t.width=this._canvasSize[0],t.height=this._canvasSize[1]),"2d"===this._contextId&&(t.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},n.prototype.recall=function(t){this.getSize();this._backBuffer.width=t.width,this._backBuffer.height=t.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(t,0,0),t.width=0,t.height=0)},n.prototype.getContext=function(t){return this._contextId=t,this._currentTarget?this._currentTarget.getContext(t):this._backBuffer.getContext(t)},n.prototype.setSize=function(t,e){s.prototype.setSize.apply(this,arguments),e&&(this._canvasSize=[e[0],e[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},i.exports=n}),i("main",["require","exports","module","famous/core/Engine","famous/core/Modifier","famous/core/Transform","famous/surfaces/ImageSurface","famous/core/Surface","famous/modifiers/StateModifier","famous/physics/PhysicsEngine","famous/physics/constraints/Collision","famous/physics/bodies/Circle","famous/physics/bodies/Body","famous/math/Vector","famous/utilities/Timer","famous/math/Random","famous/core/EventHandler","famous/surfaces/CanvasSurface"],function(t){var e=t("famous/core/Engine"),i=(t("famous/core/Modifier"),t("famous/core/Transform")),n=t("famous/surfaces/ImageSurface"),s=t("famous/core/Surface"),r=t("famous/modifiers/StateModifier"),o=t("famous/physics/PhysicsEngine"),a=t("famous/physics/constraints/Collision"),h=t("famous/physics/bodies/Circle"),u=(t("famous/physics/bodies/Body"),t("famous/math/Vector"),t("famous/utilities/Timer")),c=t("famous/math/Random"),l=t("famous/core/EventHandler"),p=t("famous/surfaces/CanvasSurface"),f=e.createContext(),d=new o,y=new s({size:[window.innerWidth,window.innerHeight],content:"Source code at https://github.com/SeanMEpi<br>Controls: w-thrust, a-rotate left, d-rotate right, l-fire<br>PRESS R TO RESET",properties:{color:"grey",backgroundColor:"#030303"}}),g=new r({transform:i.translate(0,0,-10)});f.add(g).add(y);var m=new p({size:[300,100],properties:{backgroundColor:"#030303"}});m.score=0,m.ships=3;var v=new r({align:[.5,0],origin:[.5,0],transform:i.translate(0,0,-5)});f.add(v).add(m);var _=function(){this.defaultSurface=null,this.deadSurface=new s({size:[1,1],properties:{backgroundColor:"#030303"}}),this.currentSurface=null,this.stateMod=null,this.particle=null,this.direction=null,this.dead=!1,this.rotationModifier=function(){return new r({transform:i.rotateZ(this.direction)})},this.addVector=function(t){var e=t*Math.cos(this.direction),i=t*Math.sin(this.direction),n=this.particle.getVelocity()[0],s=this.particle.getVelocity()[1],r=n+e,o=s+i;this.particle.setVelocity([r,o,0])},this.getMagnitude=function(){return Math.sqrt(this.particle.getVelocity()[0]*this.particle.getVelocity()[0]+this.particle.getVelocity()[1]*this.particle.getVelocity()[1])},this.setRandomPositionAndDirection=function(t){var e=c.range(0,2*Math.PI);this.direction=e,this.addVector(t);var i=c.integer(-window.innerWidth,window.innerWidth),n=c.integer(-window.innerHeight,window.innerHeight);this.particle.setPosition([i,n,0])},this.wraparound=function(){this.particle.getPosition()[0]>=window.innerWidth/2?this.particle.setPosition([-window.innerWidth/2,this.particle.getPosition()[1],0]):this.particle.getPosition()[0]<=-window.innerWidth/2?this.particle.setPosition([window.innerWidth/2,this.particle.getPosition()[1],0]):this.particle.getPosition()[1]>=window.innerHeight/2?this.particle.setPosition([this.particle.getPosition()[0],-window.innerHeight/2,0]):this.particle.getPosition()[1]<=-window.innerHeight/2&&this.particle.setPosition([this.particle.getPosition()[0],window.innerHeight/2,0])},this.magnitudeLimit=function(t){var e=Math.sqrt(this.particle.getVelocity()[0]*this.particle.getVelocity()[0]+this.particle.getVelocity()[1]*this.particle.getVelocity()[1]);if(e>=t){var i=t*Math.cos(this.direction),n=t*Math.sin(this.direction);this.particle.setVelocity([i,n,0])}},this.allowShield=!0,this.shieldCounter=0,this.shieldTimer=function(t){this.shieldCounter+=t,this.shieldCounter>=1800&&(this.shieldCounter=1800,this.shieldOff(),this.allowShield=!1)},this.shieldOn=function(){this.currentSurface=this.shipWithShield,f.add(this.state).add(this.rotationModifier()).add(this.currentSurface),this.collision.shield=!0},this.shieldOff=function(){this.currentSurface=this.shipSurface,f.add(this.state).add(this.rotationModifier()).add(this.currentSurface),this.collision.shield=!1},this.reset=function(){this.particle.setPosition([0,0,0]),this.direction=3*Math.PI/2,this.currentSurface=this.defaultSurface,f.add(this.stateMod).add(this.rotationModifier()).add(this.currentSurface),this.collision.alive=!0}},S=function(){this.defaultSurface=new n({size:[52,52],content:"/content/images/ship_4.png"}),this.shipWithShield=new n({size:[52,52],content:"/content/images/ship_3_shields.png"}),this.currentSurface=this.defaultSurface,this.stateMod=new r({align:[.5,.5],origin:[.5,.5]}),this.particle=new h({radius:20}),this.direction=3*Math.PI/2,this.eventHandler=new l,this.eventHandler.currentSurface=this.currentSurface,this.eventHandler.stateMod=this.stateMod,this.eventHandler.particle=this.particle,this.eventHandler.explode=function(t){this.explosionSurface=new n({size:[100,100],content:"/content/images/graphics-explosions-210621.gif"}),this.currentSurface=this.explosionSurface,f.add(this.stateMod).add(this.currentSurface),this.explosionTimer=t},this.torpTimer=0};S.prototype=new _;var w=function(){this.defaultSurface=new n({size:[100,100],content:"/content/images/asteroid_2.png"}),this.currentSurface=this.defaultSurface,this.stateMod=new r({align:[.5,.5],origin:[.5,.5]}),this.particle=new h({radius:20}),this.particle.setMass(32),this.eventHandler=new l,this.eventHandler.currentSurface=this.currentSurface,this.eventHandler.stateMod=this.stateMod,this.eventHandler.particle=this.particle,this.eventHandler.explodeAllow=!0,this.eventHandler.explode=function(t){m.score+=10,this.explodeAllow=!1,this.particle.setVelocity([0,0,0]),this.explosionSurface=new n({size:[100,100],content:"/content/images/graphics-explosions-210621.gif"}),this.currentSurface=this.explosionSurface,f.add(this.stateMod).add(this.currentSurface),this.explosionTimer=t,F(x),O(I[I.length-1],D),H(I[I.length-1]);var e=c.integer(-10,10),i=c.integer(-10,10),s=this.particle.getPosition()[0]+e,r=this.particle.getPosition()[1]+i;I[I.length-1].particle.setPosition([s,r,0]),F(x),O(I[I.length-1],D),H(I[I.length-1]),e=c.integer(-10,10),i=c.integer(-10,10),s=this.particle.getPosition()[0]+e,r=this.particle.getPosition()[1]+i,I[I.length-1].particle.setPosition([s,r,0])}};w.prototype=new _;var x=function(){this.defaultSurface=new n({size:[50,50],content:"/content/images/asteroid_medium.png"}),this.currentSurface=this.defaultSurface,this.stateMod=new r({align:[.5,.5],origin:[.5,.5]}),this.particle=new h({radius:20}),this.particle.setMass(16),this.eventHandler=new l,this.eventHandler.currentSurface=this.currentSurface,this.eventHandler.stateMod=this.stateMod,this.eventHandler.particle=this.particle,this.eventHandler.explodeAllow=!0,this.eventHandler.explode=function(t){m.score+=20,this.explodeAllow=!1,this.particle.setVelocity([0,0,0]);this.particle.getPosition()[0],this.particle.getPosition()[1];this.explosionSurface=new n({size:[100,100],content:"/content/images/graphics-explosions-210621.gif"}),this.currentSurface=this.explosionSurface,f.add(this.stateMod).add(this.currentSurface),this.explosionTimer=t}};x.prototype=new _;var b=function(){this.defaultSurface=new n({size:[25,25],content:"/content/images/asteroid_small.png"}),this.currentSurface=this.defaultSurface,this.stateMod=new r({align:[.5,.5],origin:[.5,.5]}),this.particle=new h({radius:20}),this.particle.setMass(8),this.eventHandler=new l,this.eventHandler.currentSurface=this.currentSurface,this.eventHandler.stateMod=this.stateMod,this.eventHandler.particle=this.particle,this.eventHandler.createDisallow=0,this.eventHandler.explode=function(t){this.particle.setVelocity([0,0,0]),this.explosionSurface=new n({size:[100,100],content:"/content/images/graphics-explosions-210621.gif"}),this.currentSurface=this.explosionSurface,f.add(this.stateMod).add(this.currentSurface),this.explosionTimer=t}};b.prototype=new _;var z=function(){this.defaultSurface=new s({size:[10,10],properties:{backgroundColor:"#63C7DB",borderRadius:"200px"}}),this.currentSurface=this.defaultSurface,this.stateMod=new r({align:[.5,.5],origin:[.5,.5]}),this.particle=new h({radius:10}),this.direction=0,this.existanceTimer=60,this.eventHandler=new l,this.eventHandler.currentSurface=this.currentSurface,this.eventHandler.stateMod=this.stateMod,this.eventHandler.particle=this.particle,this.eventHandler.explode=function(t){this.particle.setVelocity([0,0,0]),this.currentSurface=this.deadSurface,f.add(this.stateMod).add(this.currentSurface),d.removeBody(this.particle),this.explosionTimer=t}};z.prototype=new _;var M=new a,T=function(t,e){for(var i=0;i<t.length;i++)O(t[i],e)},O=function(t,e){for(var i=0;i<e.length;i++)d.attach(M,t.particle,e[i].particle)};M.broadcast=new l,M.on("collision",function(t){this.broadcast.emit(t.source.ID),this.broadcast.emit(t.target.ID)});var C={};e.on("keydown",function(t){C[t.keyCode||t.which]=!0},!0),e.on("keyup",function(t){C[t.keyCode||t.which]=!1},!0);var P=function(t){d.removeBody(t.particle),t.currentSurface=t.deadSurface,f.add(t.stateMod).add(t.currentSurface),t.dead=!0};u.every(function(){for(var t=0;t<D.length;t++)D[t].magnitudeLimit(1),D[t].stateMod.setTransform(D[t].particle.getTransform()),D[t].wraparound(),C[65]&&(D[t].direction-=Math.PI/32,f.add(D[t].stateMod).add(D[t].rotationModifier()).add(D[t].currentSurface)),C[68]&&(D[t].direction+=Math.PI/32,f.add(D[t].stateMod).add(D[t].rotationModifier()).add(D[t].currentSurface)),C[87]&&D[t].addVector(.02),C[82]&&(sessionStorage.score=m.score,sessionStorage.ships=m.ships,location.reload()),D[t].eventHandler.explosionTimer>0&&(D[t].eventHandler.explosionTimer-=1,0===D[t].eventHandler.explosionTimer&&(m.ships-=1,P(D[t]),sessionStorage.score=m.score,sessionStorage.ships=m.ships,location.reload())),D[t].torpTimer>0&&(D[t].torpTimer-=1),C[76]&&V.length<4&&0===D[t].torpTimer&&q(D[t]);for(var t=0;t<I.length;t++)I[t].magnitudeLimit(1),I[t].stateMod.setTransform(I[t].particle.getTransform()),I[t].wraparound(),I[t].eventHandler.createDisallow>0&&(I[t].eventHandler.createDisallow-=1),I[t].eventHandler.explosionTimer>0&&(I[t].eventHandler.explosionTimer-=1,0===I[t].eventHandler.explosionTimer&&(P(I[t]),I.splice(t,1)));for(var t=0;t<V.length;t++)V[t].stateMod.setTransform(V[t].particle.getTransform()),V[t].wraparound(),V[t].eventHandler.explosionTimer>0&&(V[t].eventHandler.explosionTimer-=1,0===V[t].eventHandler.explosionTimer&&(P(V[t]),V.splice(t,1))),V[t].existanceTimer>0&&(V[t].existanceTimer-=1,0===V[t].existanceTimer&&(P(V[t]),V.splice(t,1)));var e=m.getContext("2d");e.font="30px Arial",e.fillStyle="white",e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText("Score: "+m.score.toString()+" Ships: "+(m.ships-1).toString(),10,50)},1);var D=[],E=function(t){for(var e=0;t>e;e++)D[e]=new S,D[e].particle.ID=e,D[e].eventHandler.subscribe(M.broadcast),D[e].eventHandler.on(e,function(){this.explode(60)})},k=function(){for(var t=0;t<D.length;t++)d.addBody(D[t].particle),D[t].currentSurface.render=function(){return this.id},f.add(D[t].stateMod).add(D[t].rotationModifier()).add(D[t].currentSurface)},I=[],A=function(t,e){for(var i=0;t>i;i++)F(e)},F=function(t){var e=I.length;I[e]=new t,I[e].particle.ID=e+2e3,I[e].eventHandler.ID=e+2e3,I[e].eventHandler.subscribe(M.broadcast),I[e].eventHandler.on((e+2e3).toString(),function(){this.explodeAllow&&this.explode(20)})},L=function(){for(var t=0;t<I.length;t++)H(I[t])},H=function(t){d.addBody(t.particle),t.currentSurface.render=function(){return this.id},t.setRandomPositionAndDirection(.1),f.add(t.stateMod).add(t.rotationModifier()).add(t.currentSurface)},V=[],q=function(t){var e=V.length;V[e]=new z,V[e].particle.ID=e+1e3,V[e].eventHandler.ID=e+1e3,V[e].eventHandler.subscribe(M.broadcast),V[e].eventHandler.on((e+1e3).toString(),function(){this.explode(0)}),O(V[e],I),d.addBody(V[e].particle),V[e].currentSurface.render=function(){return this.id},V[e].direction=t.direction,V[e].particle.setPosition(t.particle.getPosition()),V[e].particle.setVelocity(t.particle.getVelocity()),V[e].addVector(.5),f.add(V[e].stateMod).add(V[e].rotationModifier()).add(V[e].currentSurface),t.torpTimer=5},G=function(){var t=parseInt(sessionStorage.score);m.score=t?t:0;var e=parseInt(sessionStorage.ships);e?m.ships=e:(m.ships=3,m.score=0),console.log("Ships Left: "+m.ships),E(1),A(5,w),T(D,I),k(),L()};G()}),e(["main"])}();